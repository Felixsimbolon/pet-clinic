if 'user_email' not in request.session:
        return redirect('login')

saya mau bikin kamu coba cari dulu di cursor apakah email ini ada di pegawai email_user, kalau ada kemudian lanjut ke if selanjutnya
misal no_pegawai yang korespon dengan email tidak ada di tabel dokter, dia juga ke login